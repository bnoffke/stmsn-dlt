# ArcGIS Dataset Configuration
# Add new datasets here - no code changes required
#
# Structure: Jurisdictions contain datasets
# - CRS is defined at jurisdiction level (drives API requests for native coordinates)
# - Geometry type is extracted automatically from service metadata

jurisdictions:
  madison:
    crs: 8193  # NAD83(HARN) / WISCRS Dane County (ftUS)
    datasets:
      - name: parcels
        layer_url: "https://maps.cityofmadison.com/arcgis/rest/services/Public/OPEN_DATA2/FeatureServer/0/query"
        description: "Madison parcel boundaries and property information"
        validation:
          enabled: true
          tolerance_percent: 5
          metrics:
            - parquet_column: total_taxes  # Column name in normalized parquet files
              aggregate: sum
              api_field: TotalTaxes  # Field name in ArcGIS API JSON response

      - name: streets
        layer_url: "https://maps.cityofmadison.com/arcgis/rest/services/Public/OPEN_DATA_ENGR/MapServer/1/query"
        description: "Madison street centerlines"

      - name: tod_overlay
        layer_url: "https://maps.cityofmadison.com/arcgis/rest/services/Public/OPEN_DATA_PLANNING/MapServer/16/query"
        description: "Madison Transit-Oriented Development Overlay Zoning District Boundary"

      - name: area_plan_overlays
        layer_url: "https://maps.cityofmadison.com/arcgis/rest/services/Public/OPEN_DATA_PLANNING/MapServer/18/query"
        description: "Madison Area Plan Overlays"

      - name: alder_district_overlays
        layer_url: "https://maps.cityofmadison.com/arcgis/rest/services/Public/OPEN_DATA/MapServer/10/query"
        description: "Madison Alder District Overlays"
      
      - name: impervious_surfaces
        layer_url: "https://maps.cityofmadison.com/arcgis/rest/services/Public/OPEN_DATA_ENGR/MapServer/7/query"
        description: "Madison impervious surfaces"

      - name: tax_roll
        layer_url: "https://maps.cityofmadison.com/arcgis/rest/services/Public/OPEN_DB_TABLES/MapServer/4/query"
        description: "Madison tax roll data"
        non_spatial: true
        validation:
          enabled: true
          tolerance_percent: 5
          metrics:
            - parquet_column: cur_total  # Column name in normalized parquet files
              aggregate: sum
              api_field: CurTotal  # Field name in ArcGIS API JSON response